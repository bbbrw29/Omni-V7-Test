<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OMNI V7 - iPad Touch Fix</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --text: #c9d1d9; --blue: #58a6ff; --green: #238636; --red: #f85149; --gold: #d29922; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); padding: 8px; margin: 0; -webkit-tap-highlight-color: transparent; }
        .container { max-width: 450px; margin: auto; }
        .master-box { background: #1c2128; border: 2px solid var(--border); border-radius: 10px; padding: 15px; text-align: center; margin-bottom: 8px; }
        .master-val { font-size: 42px; font-weight: bold; margin: 0; }
        
        /* Keypad Styling */
        .keypad { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 10px; padding: 5px; }
        .key { 
            background: #21262d; border: 1px solid var(--border); color: white; 
            padding: 20px 0; border-radius: 10px; font-size: 24px; font-weight: bold; 
            text-align: center; cursor: pointer; touch-action: manipulation;
        }
        .key:active { background: var(--blue); transform: scale(0.95); }
        
        .util-row { display: flex; gap: 8px; margin-bottom: 10px; }
        .btn-util { flex: 1; padding: 15px; background: #30363d; color: white; border: none; border-radius: 10px; font-size: 14px; font-weight: bold; }

        .live-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; background: var(--card); border: 1px solid var(--border); }
        .live-table td { padding: 12px; text-align: center; border: 1px solid var(--border); font-weight: bold; }

        .history-wrapper { border-radius: 8px; border: 1px solid var(--border); background: var(--card); max-height: 250px; overflow-y: auto; }
        table.hist-table { width: 100%; border-collapse: collapse; }
        .hist-table th { background: #21262d; padding: 10px; font-size: 11px; position: sticky; top: 0; }
        .hist-table td { padding: 12px; border-bottom: 1px solid var(--border); text-align: center; }
        
        .B-text { color: var(--blue); } .S-text { color: var(--green); }
    </style>
</head>
<body>

<div class="container">
    <div class="master-box">
        <div id="mVal" class="master-val">-</div>
        <div id="mConf" style="font-size: 13px; color: #8b949e; margin-top: 5px;">ဂဏန်းများ နှိပ်ပေးပါ</div>
    </div>

    <div class="keypad">
        <div class="key" ontouchstart="pressKey(1)" onclick="pressKey(1)">1</div>
        <div class="key" ontouchstart="pressKey(2)" onclick="pressKey(2)">2</div>
        <div class="key" ontouchstart="pressKey(3)" onclick="pressKey(3)">3</div>
        <div class="key" ontouchstart="pressKey(4)" onclick="pressKey(4)">4</div>
        <div class="key" ontouchstart="pressKey(5)" onclick="pressKey(5)">5</div>
        <div class="key" ontouchstart="pressKey(6)" onclick="pressKey(6)">6</div>
        <div class="key" ontouchstart="pressKey(7)" onclick="pressKey(7)">7</div>
        <div class="key" ontouchstart="pressKey(8)" onclick="pressKey(8)">8</div>
        <div class="key" ontouchstart="pressKey(9)" onclick="pressKey(9)">9</div>
        <div class="key" ontouchstart="pressKey(0)" onclick="pressKey(0)">0</div>
    </div>

    <div class="util-row">
        <button class="btn-util" style="background: var(--red);" ontouchstart="undoLast()" onclick="undoLast()">UNDO</button>
        <button class="btn-util" ontouchstart="resetApp()" onclick="resetApp()">RESET</button>
    </div>

    <table class="live-table">
        <tbody>
            <tr><td style="color:#8b949e">A</td><td id="a5">-</td><td id="a7">-</td><td id="a10">-</td></tr>
            <tr><td style="color:#8b949e">B</td><td id="b5">-</td><td id="b7">-</td><td id="b10">-</td></tr>
            <tr><td style="color:#8b949e">C</td><td id="c5">-</td><td id="c7">-</td><td id="c10">-</td></tr>
        </tbody>
    </table>

    <div class="history-wrapper">
        <table class="hist-table">
            <thead><tr><th>ID</th><th>Res</th><th>Pred</th></tr></thead>
            <tbody id="histBody"></tbody>
        </table>
    </div>
</div>

<script>
    let digits = JSON.parse(localStorage.getItem('omni_v7_final')) || [];
    let history = [];

    window.onload = () => { analyze(); };

    function pressKey(num) {
        digits.push(num);
        localStorage.setItem('omni_v7_final', JSON.stringify(digits));
        analyze();
    }

    function analyze() {
        history = []; let temp = []; let lp = { final: "-" };
        digits.forEach((v) => {
            const act = v >= 5 ? "B" : "S";
            if (lp.final !== "-") {
                const ck = (p, a) => p === a ? "✅" : "❌";
                history.unshift({ id: history.length + 1, res: `${v}(${act})`, pred: `${lp.final}${ck(lp.final, act)}` });
            }
            temp.push(v);
            if (temp.length >= 8) {
                // Calculation Logic ...
                const calc = (w, d) => (d.slice(-w).reduce((a,b)=>a+b,0) % 2 === 0 ? "S" : "B");
                let a5=calc(5,temp), b5=calc(5,temp), c5=calc(5,temp);
                lp = { final: (a5==="B"||b5==="B"?"B":"S"), a5, a7:calc(7,temp), a10:calc(10,temp), b5, b7:calc(7,temp), b10:calc(10,temp), c5, c7:calc(7,temp), c10:calc(10,temp) };
            }
        });
        render(lp);
    }

    function undoLast() { digits.pop(); localStorage.setItem('omni_v7_final', JSON.stringify(digits)); analyze(); }
    function resetApp() { if(confirm("Reset?")) { digits=[]; localStorage.removeItem('omni_v7_final'); location.reload(); } }

    function render(lp) {
        if (digits.length < 8) {
            document.getElementById('mConf').innerText = `${8 - digits.length} လုံး လိုပါသေးသည်`;
            document.getElementById('mVal').innerText = "-";
            return;
        }
        document.getElementById('mVal').innerText = lp.final === "B" ? "BIG" : "SMALL";
        document.getElementById('mVal').className = "master-val " + (lp.final === "B" ? "B-text" : "S-text");
        document.getElementById('mConf').innerText = "LIVE";
        document.getElementById('histBody').innerHTML = history.map(h => `<tr><td>${h.id}</td><td>${h.res}</td><td>${h.pred}</td></tr>`).join('');
    }
</script>
</body>
</html>
