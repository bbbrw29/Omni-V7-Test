<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OMNI V7 - iPad Pro Version</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --text: #c9d1d9; --blue: #58a6ff; --green: #238636; --red: #f85149; --gold: #d29922; --btn-bg: #21262d; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); padding: 10px; margin: 0; -webkit-tap-highlight-color: transparent; }
        .container { max-width: 500px; margin: auto; }
        
        /* Top Action Buttons */
        .top-nav { display: flex; gap: 8px; margin-bottom: 10px; }
        .btn-nav { flex: 1; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--btn-bg); color: var(--blue); font-size: 12px; font-weight: bold; cursor: pointer; }

        .master-box { background: #1c2128; border: 2px solid var(--border); border-radius: 12px; padding: 25px; text-align: center; margin-bottom: 10px; }
        .master-val { font-size: 48px; font-weight: 900; margin: 0; letter-spacing: 2px; }
        .status-text { font-size: 12px; color: #8b949e; margin-top: 5px; text-transform: uppercase; }

        /* Keypad Section */
        .keypad { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 10px; }
        .key { background: var(--btn-bg); border: 1px solid var(--border); color: white; padding: 22px 0; border-radius: 10px; font-size: 22px; font-weight: bold; text-align: center; cursor: pointer; touch-action: manipulation; }
        .key:active { background: var(--blue); transform: scale(0.95); }

        .action-row { display: flex; gap: 8px; margin-bottom: 10px; }
        .btn-main { flex: 1; padding: 15px; border-radius: 8px; border: none; font-weight: bold; font-size: 14px; cursor: pointer; }
        .btn-copy { background: #30363d; color: white; }
        .btn-reset { background: #21262d; color: var(--red); }
        .btn-undo { background: var(--red); color: white; width: 80px; }

        /* Tables */
        .abc-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; background: var(--card); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
        .abc-table td { padding: 12px; text-align: center; border: 1px solid var(--border); font-weight: bold; font-size: 15px; }
        .label { color: #8b949e; font-size: 13px; font-weight: normal; background: #1c2128; }

        .history-wrapper { border-radius: 10px; border: 1px solid var(--border); background: var(--card); max-height: 350px; overflow-y: auto; }
        table.main-table { width: 100%; border-collapse: collapse; }
        .main-table th { background: #21262d; padding: 12px; font-size: 11px; color: #8b949e; position: sticky; top: 0; border-bottom: 2px solid var(--border); }
        .main-table td { padding: 12px; border-bottom: 1px solid var(--border); text-align: center; font-size: 14px; }
        
        .B-text { color: var(--blue); } .S-text { color: var(--green); }
        .match-icon { color: var(--green); font-weight: bold; }
        .miss-icon { color: var(--red); font-weight: bold; }
        .abc-icons { font-size: 12px; letter-spacing: 2px; }
    </style>
</head>
<body>

<div class="container">
    <div class="top-nav">
        <button class="btn-nav" onclick="saveData()">üíæ SAVE DIGITS</button>
        <button class="btn-nav" onclick="loadData()">üìÇ LOAD DIGITS</button>
    </div>

    <div class="master-box">
        <div id="mVal" class="master-val">-</div>
        <div id="mStatus" class="status-text">Waiting for data</div>
    </div>

    <div class="keypad">
        <div class="key" ontouchstart="pressKey(1)" onclick="pressKey(1)">1</div>
        <div class="key" ontouchstart="pressKey(2)" onclick="pressKey(2)">2</div>
        <div class="key" ontouchstart="pressKey(3)" onclick="pressKey(3)">3</div>
        <div class="key" ontouchstart="pressKey(4)" onclick="pressKey(4)">4</div>
        <div class="key" ontouchstart="pressKey(5)" onclick="pressKey(5)">5</div>
        <div class="key" ontouchstart="pressKey(6)" onclick="pressKey(6)">6</div>
        <div class="key" ontouchstart="pressKey(7)" onclick="pressKey(7)">7</div>
        <div class="key" ontouchstart="pressKey(8)" onclick="pressKey(8)">8</div>
        <div class="key" ontouchstart="pressKey(9)" onclick="pressKey(9)">9</div>
        <div class="key" ontouchstart="pressKey(0)" onclick="pressKey(0)">0</div>
    </div>

    <div class="action-row">
        <button class="btn-main btn-undo" ontouchstart="undo()" onclick="undo()">UNDO</button>
        <button class="btn-main btn-copy" onclick="copyTable()">COPY TABLE</button>
        <button class="btn-main btn-reset" onclick="resetApp()">RESET</button>
    </div>

    <table class="abc-table">
        <tbody id="abcBody">
            <tr><td class="label">Sum(A)</td><td id="a5">-</td><td id="a7">-</td><td id="a10">-</td></tr>
            <tr><td class="label">Mat(B)</td><td id="b5">-</td><td id="b7">-</td><td id="b10">-</td></tr>
            <tr><td class="label">Tre(C)</td><td id="c5">-</td><td id="c7">-</td><td id="c10">-</td></tr>
        </tbody>
    </table>

    <div class="history-wrapper">
        <table class="main-table">
            <thead>
                <tr><th>ID</th><th>RES</th><th>PRED</th><th>CYC</th><th>ABC</th></tr>
            </thead>
            <tbody id="histBody"></tbody>
        </table>
    </div>
</div>

<script>
    let digits = JSON.parse(localStorage.getItem('omni_v7_pro')) || [];
    let history = [];

    window.onload = () => analyze();

    function pressKey(n) { digits.push(n); update(); }
    function undo() { digits.pop(); update(); }
    function update() { localStorage.setItem('omni_v7_pro', JSON.stringify(digits)); analyze(); }

    const getA = (w, d) => d.length < w ? "-" : (d.slice(-w).reduce((a,b)=>a+b,0) % 2 === 0 ? "S" : "B");
    const getB = (w, d) => d.length < w ? "-" : ((d.slice(-w).reduce((a,b)=>a+b,0) % 10) % 2 === 0 ? "S" : "B");
    const getC = (w, d) => {
        if(d.length < w) return "-";
        let win = d.slice(-w);
        let diff = win[win.length-1] - win[0];
        return diff > 0 ? "B" : (diff < 0 ? "S" : (win[win.length-1] >= 5 ? "B" : "S"));
    };

    function analyze() {
        history = []; let temp = []; let lp = { final: "-" };
        digits.forEach((v, i) => {
            const act = v >= 5 ? "B" : "S";
            let cyc = "-";
            if (temp.length >= 10) cyc = (act === (temp[temp.length-10] >= 5 ? "B" : "S")) ? "M" : "D";
            
            if (lp.final !== "-") {
                const ck = (p, a) => p === a ? "‚úÖ" : "‚ùå";
                const abc_checks = `<span class="abc-icons">${ck(lp.a5, act)}|${ck(lp.b5, act)}|${ck(lp.c5, act)}</span>`;
                history.unshift({
                    id: history.length + 1,
                    res: `<b>${v}
